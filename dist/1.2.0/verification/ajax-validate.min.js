!function(){function t(t,i,e,n){(a=function(t){return this.init(t),this.timeoutIndex=0,this}).prototype={init:function(a){this.constData=t.extend({},{cipher:1},a.constData||{}),this.data={},this.form=a.form||{},this.url=a.url||"",this.type=a.type||"get",this.dataType=a.dataType||"json",self.ajaxSwitch=!1,this.validator={},this.enterToSubmit=a.enterToSubmit||!1;for(var i in a.form)a.form[i].name||(a.form[i].name=""),this.validator[i]=a.form[i].validator;a.successTip&&(this.successTip=a.successTip),a.failTip&&(this.failTip=a.failTip),a.onComplete&&(this.onComplete=a.onComplete),this.changeValidate()},successTip:function(t,a){n.success("操作成功"),t.redirectUrl&&setTimeout(function(){document.location.href=redirectUrl},0)},failTip:function(t,a,i){n.error(t,a)},onComplete:function(t,a){},changeValidate:function(){var a=this;t.each(this.form,function(i,n){var o=n.name,r=t(n.valueArea),s=n.tipArea,u=n.formatter,d=n.validator;if(r&&a.enterToSubmit&&r.on("keyup","",function(t){13!==t.keyCode&&108!==t.keyCode||a.submit()}),!r.hasClass("disabled")&&d&&s){var f=!0;r.on("change vChange","",function(){var t=r.val();u&&(t=u(r.val())),!0===(f=d instanceof Function?d(t):e.judge(t,d))?a.failTip("",s):"string"==typeof f?a.failTip(o+f,s):a.failTip(f[0]+o+f[1],s)})}})},singleValidate:function(t,a){var i=this.validator[t];return i instanceof Function?i(a):!i||e.judge(a,i)},submit:function(t,a){a&&a.withoutValidate?(this.getParamsData(),this.ajaxSwitch||this.endValidate(t)):this.ajaxSwitch||this.fontValidate()&&this.endValidate(t)},getParamsData:function(){var a=this;return this.data={},t.each(this.form,function(i,e){var n=t(e.valueArea),o=e.formatter,r=e.preposter;if(""===n.val())return!0;a.data[i]=o?o(n.val()):n.val(),r&&(a.data[i]=r(a.data[i]))}),a.data},fontValidate:function(){var a=this,i=!0;return this.data={},t.each(this.form,function(n,o){var r=o.name,s=t(o.valueArea),u=o.tipArea,d=o.validator,f=o.formatter,c=o.preposter;if(a.data[n]=f?f(s.val()):s.val(),!s.hasClass("disabled")&&!s.attr("disabled")&&d){if(!0!==(i=d instanceof Function?d(a.data[n]):e.judge(a.data[n],d))&&"string"==typeof i)return a.failTip(r+i,u),!1;if(!0!==i)return a.failTip(i[0]+r+i[1],u),!1}c&&(a.data[n]=c(a.data[n]))}),!0===i},endValidate:function(e){var n=this;e=e||{};var o=t.extend({},n.constData,e,n.data);n.ajaxSwitch=!0,t.ajax({url:n.url,type:n.type,data:o,dataType:n.dataType,success:function(t){var a={};i.apiError(t,a)?n.successTip(t.data,o):n.failTip(a,null,o),n.onComplete&&n.onComplete(t.data||{},o)},error:function(){n.failTip("服务器异常，请稍后再试！")},complete:function(){n.ajaxSwitch=!1},statusCode:{403:function(){a.hook403&&a.hook403()}}})}},window.GAjaxValidate=a}var a=function(){};"function"==typeof define&&define.amd?define("GAjaxValidate",["require","jquery","G","gValidate","gTips"],function(i){return t(i("jquery"),i("G"),i("gValidate"),i("gTips")),a}):"object"==typeof module&&"object"==typeof module.exports?(t(require("jquery"),require("G"),require("gValidate"),require("gTips")),module.exports=a):t(window.jQuery,window.G,window.gValidate,window.gTips)}();