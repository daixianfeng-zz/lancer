!function(){function n(n,i,o,c){function r(n){n.config.runSecond=n.config.resendSecond,n.config.btnArea.html(n.config.runText+n.config.runSecond+"s"),clearInterval(n.codeInterval),n.codeInterval=setInterval(function(){n.config.btnArea.html(n.config.runText+n.config.runSecond+"s"),n.config.runSecond-=1,n.config.runSecond<0&&(n.config.btnArea.html(n.config.oriText),n.config.btnArea.removeClass("disabled"),n.config.runSecond=n.config.resendSecond,clearInterval(n.codeInterval))},1e3)}var a={resendSecond:60,clickStart:!0,sendUrl:"",phoneParam:"cellphone",captchaParam:"captcha",oriText:"点击获取",runText:"再次获取 ",successTip:"验证码已经发送，请查收！",errorTip:"",sendData:{},isCellphoneJudge:!0,isCaptchaJudge:!1};(e=function(e){return this.config=n.extend({},a,e),this.codeInterval=0,this.init(),this}).prototype={init:function(){var n=this;n.config.runSecond=n.config.resendSecond,n.config.btnArea.on("click",function(){return n.send(),!1})},getData:function(){return this.config.getData instanceof Function?this.config.getData():{}},_send:function(e){var a=this;if(a.config.btnArea.hasClass("disabled"))return!1;var t=!0;if(a.config.isCellphoneJudge){var f=e[a.config.phoneParam];t=o.judgeCellphone(f)}return!0!==t?(c.error("请输入正确的手机号码",a.config.tipArea),!1):(a.config.isCaptchaJudge&&(e[a.config.captchaParam]||(t=!1)),!0!==t?(c.error("请输入图片验证码",a.config.tipArea),!1):(!0===t&&(a.config.btnArea.addClass("disabled"),n.ajax({url:a.config.sendUrl,type:"post",data:e,dataType:"json",success:function(n){var e={};i.apiError(n,e)?(r(a),c.success("验证码已经发送，请查收！",a.config.tipArea),a.config.onSuccess instanceof Function&&a.config.onSuccess(n.data)):(c.error(e.message,a.config.tipArea),a.config.btnArea.removeClass("disabled"),a.config.isCaptchaJudge&&a.config.refreshCaptcha(),a.config.onError instanceof Function&&a.config.onError(n.data))},error:function(){a.config.btnArea.removeClass("disabled"),a.config.onError instanceof Function&&a.config.onError({})}})),!1))},reset:function(){this.config.runSecond=0},start:function(){this.config.btnArea.addClass("disabled"),r(this)},send:function(){var e=this;if(e.config.isCellphoneJudge){var i=e.config.cellphoneArea.val();e.config.sendData[e.config.phoneParam]=i}if(e.config.isCaptchaJudge){var o=e.config.captchaArea.val();e.config.sendData[e.config.captchaParam]=o}if(!1===e.getData())return!1;e.config.clickStart&&e._send(n.extend({},e.config.sendData,e.getData()))}};window.GVerification=e}var e=function(){};"function"==typeof define&&define.amd?define("GVerification",["require","jquery","G","gValidate","gTips"],function(i){return n(i("jquery"),i("G"),i("gValidate"),i("gTips")),e}):"object"==typeof module&&"object"==typeof module.exports?(n(require("jquery"),require("G"),require("gValidate"),require("gTips")),module.exports=e):n(window.jQuery,window.G,window.gValidate,window.gTips)}();