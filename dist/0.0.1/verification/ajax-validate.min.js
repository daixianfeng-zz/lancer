!function(){function t(t,a,e,n){(i=function(t){return this.init(t),this.timeoutIndex=0,this}).prototype={init:function(i){this.constData=t.extend({},{cipher:1},i.constData||{}),this.data={},this.form=i.form||{},this.url=i.url||"",this.type=i.type||"get",this.dataType=i.dataType||"json",self.ajaxSwitch=!1,this.validator={},this.enterToSubmit=i.enterToSubmit||!1;for(var a in i.form)i.form[a].name||(i.form[a].name=""),this.validator[a]=i.form[a].validator;i.successTip&&(this.successTip=i.successTip),i.failTip&&(this.failTip=i.failTip),i.onComplete&&(this.onComplete=i.onComplete),this.changeValidate()},successTip:function(t){n.success("操作成功"),t.redirectUrl&&setTimeout(function(){document.location.href=redirectUrl},0)},failTip:function(t,i){n.error(t,i)},onComplete:function(t){},changeValidate:function(){var i=this;t.each(this.form,function(a,n){var o=n.name,r=t(n.valueArea),s=n.tipArea,u=n.formatter,d=n.validator;if(r&&i.enterToSubmit&&r.on("keyup","",function(t){13!==t.keyCode&&108!==t.keyCode||i.submit()}),!r.hasClass("disabled")&&d&&s){var f=!0;r.on("change","",function(){var t=r.val();u&&(t=u(r.val())),!0===(f=d instanceof Function?d(t):e.judge(t,d))?i.failTip("",s):"string"==typeof f?i.failTip(o+f,s):i.failTip(f[0]+o+f[1],s)})}})},singleValidate:function(t,i){return!this.validator[t]||this.validator[t](i)},submit:function(t){this.ajaxSwitch||this.fontValidate()&&this.endValidate(t)},fontValidate:function(){var i=this,a=!0;return this.data={},t.each(this.form,function(n,o){var r=o.name,s=t(o.valueArea),u=o.tipArea,d=o.validator,f=o.formatter,c=o.preposter;o.validateArea;if(i.data[n]=f?f(s.val()):s.val(),!s.hasClass("disabled")&&s.is(":visible")&&d){if(!0!==(a=d instanceof Function?d(i.data[n]):e.judge(i.data[n],d))&&"string"==typeof a)return i.failTip(r+a,u),!1;if(!0!==a)return i.failTip(a[0]+r+a[1],u),!1}c&&(i.data[n]=c(i.data[n]))}),!0===a},endValidate:function(e){var n=this;e=e||{};var o=t.extend({},n.constData,e,n.data);n.ajaxSwitch=!0,t.ajax({url:n.url,type:n.type,data:o,dataType:n.dataType,success:function(t){var i={};a.apiError(t,i)?n.successTip(t.data):n.failTip(i),n.onComplete&&n.onComplete(t.data||{})},error:function(){n.failTip("服务器异常，请稍后再试！")},complete:function(){n.ajaxSwitch=!1},statusCode:{403:function(){i.hook403&&i.hook403()}}})}},window.GAjaxValidate=i}var i=function(){};"function"==typeof define&&define.amd?define("GAjaxValidate",["require","jquery","G","gValidate","gTips"],function(a){return t(a("jquery"),a("G"),a("gValidate"),a("gTips")),i}):"object"==typeof module&&"object"==typeof module.exports?(t(require("jquery"),require("G"),require("gValidate"),require("gTips")),module.exports=i):t(window.jQuery,window.G,window.gValidate,window.gTips)}();